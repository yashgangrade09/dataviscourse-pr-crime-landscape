<html> 
  <head> 
    <title>OpenLayers Solution</title> 

    <script src="js/OpenLayers.js"></script> 
   <script src="https://d3js.org/d3.v5.js"></script>
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
   integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
   crossorigin=""></script>
   <script type='text/javascript' src='crimePoints.json'></script>
 </head> 
<body>
<div id="mapid" style="height: 600px"></div> 
<script type="text/javascript">
    var mymap = L.map('mapid').setView([40.759759, -111.861619], 13);

    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
    maxZoom: 18,
    minZoom: 10
    }).addTo(mymap);
    colors = ['#AA3939', '#226666', '#7B9F35']

    var marker = L.marker([40.759759, -111.861619]).addTo(mymap);

    var greenIcon = new L.Icon({
        iconUrl: 'img/marker-icon-2x-green.png',
          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
          iconSize: [25, 41],
          iconAnchor: [12, 41],
          popupAnchor: [1, -34],
          shadowSize: [41, 41]
      });
    var redIcon = new L.Icon({
        iconUrl: 'img/marker-icon-2x-red.png',
          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
          iconSize: [25, 41],
          iconAnchor: [12, 41],
          popupAnchor: [1, -34],
          shadowSize: [41, 41]
      });
    var orangeIcon = new L.Icon({
        iconUrl: 'img/marker-icon-2x-orange.png',
          shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
          iconSize: [25, 41],
          iconAnchor: [12, 41],
          popupAnchor: [1, -34],
          shadowSize: [41, 41]
      });

    var icons = [redIcon, greenIcon, orangeIcon];

    function showYearData(markers) {

        for(let i = 0; i < markers.length; i++){
            // let color;
            // if(markers[i]["UCR DESCRIPTION"] == "TRAFFIC")
            //     color = colors[0];
            // else if(markers[i]["UCR DESCRIPTION"] == "LARCENY")
            //     color = colors[1];
            // else
            //     color = colors[2];

            // L.circle( [markers[i].LATITUDE, markers[i].LONGITUDE],                     
            //             {color: color,
            //             fillColor: color,
            //             fillOpacity: 0.5,
            //             radius: 30
            //             })
            //  .bindPopup("Location of Crime: " + markers[i].Location + "<br>Crime Type: " + markers[i].crimeType)
            //  .addTo(mymap);
            let icon;
            if(markers[i]["UCR DESCRIPTION"] == "TRAFFIC")
                icon = icons[0];
            else if(markers[i]["UCR DESCRIPTION"] == "LARCENY")
                icon = icons[1];
            else
                icon = icons[2];

            L.marker([markers[i].LATITUDE, markers[i].LONGITUDE], {icon: icon})
             .bindPopup("Location of Crime: " + markers[i].LOCATION + "<br>Crime Type: " + markers[i]["UCR DESCRIPTION"] + "<br>Date of Occurence: " + markers[i]["OCCUR DATE"])
             // .addTo(mymap);
        }
    }
    
    d3.csv('dummydata/2009.csv').then(function(yearData){
        // console.log(JSON.parse(JSON.stringify(yearData)));
        showYearData(JSON.parse(JSON.stringify(yearData)));
    });

</script>

</body> 
</html> 